<!doctype html>
<html  xmlns:th="http://thymeleaf.org">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Mis Postulaciones - Asocabildos</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <link href="style.css" rel="stylesheet">
</head>
<body class="d-flex flex-column vh-100 bg-light">
    <div th:insert="layout/header :: header"></div>
    
    <main class="flex-grow-1 py-5">
        <section class="container">
            <h2 class="mt-2 mb-4 fw-bold text-success border-bottom pb-2">Mi Historial de Postulaciones</h2>
            
            <div class="card shadow border-0">
                <div class="table-responsive">
                    <table class="table table-hover table-striped align-middle mb-0">
                      <thead class="table-dark">
                        <tr>
                          <th>Oferta Laboral</th>
                          <th>Fecha Postulación</th>
                          <th>Estado</th>
                          <th>Acciones</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr th:each="postulant: ${postulants}">
                            <!-- Título de la Oferta -->
                            <td class="fw-bold" th:text="${postulant.jobOffer.title}"></td>
                            
                            <!-- Fecha de Postulación -->
                            <td><span class="small text-muted">Reciente</span></td>
                            
                            <!-- Estado -->
                            <td>
                                <span th:if="${postulant.estado == 'pendiente'}" class="badge bg-warning text-dark fw-bold">Pendiente</span>
                                <span th:if="${postulant.estado == 'aceptado'}" class="badge bg-success fw-bold">Aceptado</span>
                                <span th:if="${postulant.estado == 'rechazado'}" class="badge bg-danger fw-bold">Rechazado</span>
                                <span th:if="${postulant.estado != 'pendiente' and postulant.estado != 'aceptado' and postulant.estado != 'rechazado'}" class="badge bg-info fw-bold" th:text="${postulant.estado}"></span>
                            </td>
                            
                            <!-- Acciones -->
                            <td>
                                <div class="d-flex gap-2">
                                    <a th:if="${postulant.estado == 'pendiente'}" th:href="@{/postulant/update-postulant/{id}(id=${postulant.id})}" class="btn btn-sm btn-outline-primary" title="Editar datos adjuntos"><i class="bi bi-pencil-square"></i> Editar</a>
                                    <a th:if="${postulant.estado == 'pendiente'}" th:href="@{/postulant/delete-postulant/{id}(id=${postulant.id})}" onclick="return confirm('¿Confirmar la cancelación de esta postulación?')" class="btn btn-sm btn-outline-danger" title="Cancelar postulación"><i class="bi bi-x-circle"></i> Cancelar</a>
                                </div>
                            </td>
                        </tr>
                        <!-- Mensaje si la lista está vacía -->
                        <tr th:if="${#lists.isEmpty(postulants)}">
                            <td colspan="4" class="text-center py-5 text-muted">
                                <i class="bi bi-inbox fs-1 d-block mb-2"></i>
                                Aún no te has postulado a ninguna oferta.
                            </td>
                        </tr>
                      </tbody>
                    </table>
                </div>  
            </div>  
        </section>
    </main>
    
    <div th:insert="layout/footer :: footer"></div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>